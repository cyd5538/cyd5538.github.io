---
sidebar_position: 2
---

# ERD와 정규화 과정

ERD(Entity Relationship Diagram)는 데이터베이스를 구축할 때 가장 기초적인 뼈대 역할을 하며, 릴레이션 간의 관계를 정의하는 중요한 요소입니다.  
이를 신경 쓰지 않고 서비스를 구축하면 단단하지 않은 골조로 건물을 짓는 것이나 다름없습니다.

## ERD의 중요성
ERD는 시스템의 요구 사항을 기반으로 작성되며, 이를 기반으로 데이터베이스를 구축합니다.  
데이터베이스 구축 이후에도 디버깅 또는 비즈니스 프로세스 재설계가 필요할 때 설계도 역할을 합니다.

:::note 비정형 데이터
비구조화 데이터를 의미하며, 미리 정의된 데이터 모델이 없거나 특정 방식으로 정리되지 않은 데이터를 뜻합니다.
:::

---

## 정규화 과정
데이터베이스의 **잘못된 종속 관계**로 인해 이상 현상이 발생할 수 있습니다. 이를 해결하고 저장 공간을 효율적으로 사용하기 위해 릴레이션을 분리하는 과정을 **정규화**(Normalization)라고 합니다.

### 데이터베이스 이상 현상
| 이상 현상 | 설명 |
|-----------|----------------------------|
| 삽입 이상 | 일부 필드가 NULL이 될 수 없어서 삽입이 어려운 문제 |
| 삭제 이상 | 하나의 데이터를 삭제하면 원치 않는 다른 데이터도 함께 삭제되는 문제 |
| 갱신 이상 | 데이터를 변경할 때, 중복된 데이터가 존재하여 모두 변경해야 하는 문제 |

---

## 정규형 원칙
정규화는 정규형(Normal Form, NF) 원칙을 기반으로 수행됩니다.

- 같은 의미를 표현하는 릴레이션이지만 더 좋은 구조로 만들어야 한다.
- 자료의 중복성을 줄여야 한다.
- 독립적인 관계는 별개의 릴레이션으로 표현해야 한다.
- 각각의 릴레이션은 독립적으로 존재할 수 있어야 한다.

### 제1정규형(1NF)
릴레이션의 모든 도메인이 **더 이상 분해될 수 없는 원자 값**으로 구성되어야 합니다.  
즉, 한 속성(열)에 여러 개의 값이 들어가면 안 됩니다.

**정규화 전 (반복 집합 존재)**  
| ID  | 수강명 |
|-----|----------------------|
| 홍철 | C++코딩테스트, 프런트특강 |

**정규화 이후 (반복 집합 제거)**  
| ID  | 수강명 |
|-----|------------------|
| 홍철 | C++코딩테스트  |
| 홍철 | 프런트특강  |

---

### 제2정규형(2NF)
릴레이션이 제1정규형을 만족하고, **부분 함수 종속성을 제거한 형태**입니다.  
즉, 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속해야 합니다.

#### 예제
| 학생ID | 과목명 | 교수명 |
|--------|--------|--------|
| 1      | 수학   | 김교수 |
| 1      | 영어   | 박교수 |

- `(학생ID, 과목명)`이 기본키
- `교수명`은 `과목명`에만 종속 → 부분 함수 종속 발생

**정규화 이후 (부분 함수 종속 제거)**  
- `학생(학생ID, 이름)`  
- `과목(과목명, 교수명)`  
- `수강(학생ID, 과목명)`

---

### 제3정규형(3NF)
릴레이션이 제2정규형을 만족하며, **이행적 함수 종속(Transitive Dependency)을 제거한 형태**입니다.

#### 이행적 함수 종속 예제
| 고객ID | 고객명 | 지역코드 | 지역명 |
|--------|--------|--------|--------|
| 1      | 김철수 | 02     | 서울   |
| 2      | 이영희 | 051    | 부산   |

- `고객ID -> 지역코드`
- `지역코드 -> 지역명`  
  → `고객ID -> 지역명`이 성립 → **이행적 함수 종속 발생**

**정규화 이후**  
- `고객(고객ID, 고객명, 지역코드)`
- `지역(지역코드, 지역명)`

---

### 보이스-코드 정규형(BCNF)
제3정규형을 만족하지만, **결정자가 후보키가 아닌 함수 종속 관계를 제거**해야 합니다.

:::note 결정자
`X -> Y`에서 `X`가 결정자, `Y`가 종속자입니다.
:::

---

## 트랜잭션과 무결성
트랜잭션(Transaction)은 데이터베이스에서 하나의 논리적 기능을 수행하기 위한 작업 단위를 의미합니다.  
트랜잭션의 특성은 **ACID**(Atomicity, Consistency, Isolation, Durability)입니다.

### ACID 특성
| 특성 | 설명 |
|------|--------------------------------------------------|
| 원자성(Atomicity) | 트랜잭션 내 작업이 모두 수행되거나 모두 수행되지 않아야 함. |
| 일관성(Consistency) | 데이터베이스가 허용된 방식으로만 변경되어야 함. |
| 격리성(Isolation) | 트랜잭션이 다른 트랜잭션에 간섭받지 않아야 함. |
| 지속성(Durability) | 성공적으로 수행된 트랜잭션은 영구적으로 반영되어야 함. |

---

### 트랜잭션 전파(Transaction Propagation)
트랜잭션을 여러 개의 메서드 호출을 통해 하나로 묶을 때, 트랜잭션을 어떻게 전파할 것인지 설정할 수 있습니다.

| 전파 방식 | 설명 |
|----------|---------------------------------|
| REQUIRED | 기존 트랜잭션이 있으면 사용, 없으면 새로 생성 |
| REQUIRES_NEW | 항상 새로운 트랜잭션 생성 |
| NESTED | 기존 트랜잭션 내부에서 중첩 실행 |

---

### 격리 수준과 문제점
| 격리 수준 | 설명 | 발생 가능 문제 |
|------------|-----------------------------|------------------|
| READ_UNCOMMITTED | 커밋되지 않은 데이터를 읽을 수 있음. | **더티 리드** |
| READ_COMMITTED | 커**밋된 데이터만 읽을 수 있음. | **반복 불가능한 조회** |
| REPEATABLE_READ | 같은 트랜잭션 내 같은 행의 조회 값 유지. | **팬텀 리드** |
| SERIALIZABLE | 가장 엄격한 격리 수준. | **성능 저하** |

---

## 무결성
무결성(Integrity)이란 데이터의 정확성, 일관성, 유효성을 유지하는 것을 의미합니다.

| 무결성 유형 | 설명 |
|------------|----------------------------|
| 개체 무결성 | 기본키는 NULL이거나 중복될 수 없음. |
| 참조 무결성 | 외래키 값은 NULL이거나 참조하는 테이블의 기본키 값이어야 함. |
| 고유 무결성 | 특정 열의 모든 값이 고유해야 함. |
| NULL 무결성 | 특정 열에 NULL이 포함될 수 없음. |
